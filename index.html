<HTML><HEAD>
<SCRIPT TYPE="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
</HEAD>
<BODY>
<div class="loginForm" style="float:left;">
<FORM ID="login">
Username:
<INPUT NAME=user TYPE=TEXT VALUE=wdr1test>
<BR />

Password:
<INPUT NAME=password TYPE=TEXT VALUE=testtest>
<BR />

<INPUT TYPE=button onclick="login()" value="Login" />
</FORM>
</DIV>


<IFRAME NAME="content" ALIGN=RIGHT WIDTH="80%" HEIGHT="100%" SRC="empty.html"></iframe>


<A HREF="">Reload</A><BR />
<A HREF="#" onclick="alert(localStorage['password'])">count</A>    
<div class="unreadList"> </div>
<div class="spacer" style="width:20%;float:left;">

</div>



<SCRIPT type="text/javascript">

api_key = "3a9p4Q74Afnu9x6f53gePqNm6ddeac82";
base_url = "https://readitlaterlist.com/v2/get?state=unread&count=10" +
  "&apikey=" + api_key;

function markAsRead(url) {
    console.log("markAsRead");
    read_url = "https://readitlaterlist.com/v2/send?" +
        "&username=" + user +
        "&password=" + password + 
        "&apikey=" + api_key +
        '&read={"0":{"url":"' + url + '"}}';
    console.log(read_url);
    // $.get(read_url);
}


function renderLinks(data) {
    $(".loginForm").hide();
    links = data.list;
    $("div.unreadList").append("<UL>");
    for (var key in links) {
        link = "<LI> <A HREF='" + links[key].url + "' target=content>" + 
            links[key].title + "</A> " +
            '[<A HREF="#" id="markread" onclick=markAsRead("' +
            links[key].url + '")>R</A>]' + "<BR />";

        $("div.unreadList").append(link);
    }
    $("div.unreadList").append("</UL>");

    $('#markread').click(function() {
        console.log("remove");
        $(this).closest("li").remove();
    });
}

function login() {
    console.log("login");
    user = document.forms["login"]["user"].value;
    password = document.forms["login"]["password"].value;

    url = base_url + "&username=" + user + "&password=" + password;
    console.log(url);

    $.getJSON(url, renderLinks);

}

</SCRIPT>
</BODY>
</HTML>
